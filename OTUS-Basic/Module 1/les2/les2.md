# Модуль 1. Введение

## Тема 2. Основы архитектуры компьютера

---

### Введение

Для эффективного программирования, особенно на системных языках вроде Rust, важно понимать, как компьютер управляет памятью и выполняет код. Это помогает писать оптимальный и безопасный код.

---

### Области памяти программы

Программа в памяти разделяется на несколько областей:

1. **Стек (stack)**

   * Хранит локальные переменные и вызовы функций.
   * Быстрый доступ, фиксированный размер.
   * Автоматическое управление: память выделяется и освобождается при входе и выходе из функции.
   * Пример: переменные внутри функции.

2. **Куча (heap)**

   * Для динамического выделения памяти.
   * Размер неограничен (ограничен памятью ОС).
   * Память нужно выделять и освобождать вручную (в Rust это делает система владения и заимствования).
   * Пример: данные в `Box`, `Vec`, `String`.

3. **Статические данные (static data)**

   * Константы и глобальные переменные.
   * Загружаются один раз и живут всю программу.

---

### Базовая модель архитектуры процессора

* **Регистр** — маленький и очень быстрый участок памяти внутри процессора для временного хранения данных.
* **ALU (арифметико-логическое устройство)** — выполняет арифметические и логические операции.
* **Память** — хранит данные и код программы.
* **Система управления** — управляет порядком выполнения команд.

Процессор последовательно читает инструкции из памяти, декодирует их и выполняет.

---

### Виртуальная и физическая память

* **Физическая память** — реальные чипы памяти в компьютере.
* **Виртуальная память** — абстракция, предоставляемая ОС, где каждая программа видит свой адресный пространство.
* **Преимущества виртуальной памяти**:

  * Изоляция процессов — одна программа не может напрямую повредить память другой.
  * Упрощение управления памятью — ОС сама переводит виртуальные адреса в физические.
  * Возможность использовать свопинг (выгрузка части памяти на диск).

---

### Потоки (Threads)

* **Что такое поток?**
  Поток — это отдельная последовательность выполнения инструкций внутри процесса.
* **Зачем нужны потоки?**
  Позволяют выполнять задачи параллельно (например, считывать данные из сети, обрабатывать их и одновременно обновлять UI).
* **Издержки и сложности:**

  * Переключение контекста между потоками занимает время.
  * Гонки данных: одновременный доступ к одним и тем же данным может привести к ошибкам.
  * Rust решает эту проблему на уровне компилятора через систему владения.

---

### Итоговые выводы

* Понимание стековой и кучевой памяти помогает эффективно управлять ресурсами в программе.
* Знание архитектуры процессора дает представление, как работают инструкции на низком уровне.
* Виртуальная память обеспечивает безопасность и изоляцию.
* Потоки позволяют создавать быстрые и отзывчивые приложения, но требуют аккуратного управления памятью.

---

### Задание для закрепления

1. Нарисуй схему, где укажи области памяти программы (стек, куча, статические данные).
2. Определи, где в твоей программе хранятся локальные переменные, а где динамические данные (например, в `Vec`).
3. Найди в интернете пример простой многопоточной программы на Rust (с использованием `std::thread`) и попробуй её запустить.
